# Utility: `createNewProject`\n\n**Source File:** `src/newProject.ts`\n\nThis document describes the `createNewProject` utility function, which is responsible for programmatically creating new project structures within Wooster.\n\n## 1. Purpose\n\nThe `createNewProject` function provides a standardized way to create a new project. This involves:\n\n*   Creating a dedicated directory for the project under the configured main projects directory (e.g., `projects/`).\n*   Creating a main Markdown file within this new directory (e.g., `projects/MyNewProject/MyNewProject.md`).\n*   Populating the main project file with a default heading structure.\n\nThis utility is intended to be used by plugins or other services within Wooster that need to initiate new projects.\n\n## 2. Function Signature\n\n```typescript\nasync function createNewProject(\n  projectName: string,\n  config: AppConfig\n): Promise<CreateProjectResult>\n```\n\n**Parameters:**\n\n*   `projectName: string`: The desired name for the new project. This name will be used for both the project directory and the main project file.\n*   `config: AppConfig`: The application\'s configuration object. The function specifically requires `config.gtd.projectsDir` to determine the base path for creating project directories.\n\n**Returns:**\n\n*   `Promise<CreateProjectResult>`: A promise that resolves to a `CreateProjectResult` object, indicating the outcome of the operation.\n\n## 3. `CreateProjectResult` Interface\n\nThe function returns an object conforming to the following interface:\n\n```typescript\ninterface CreateProjectResult {\n  success: boolean;        // True if the project was created successfully, false otherwise.\n  message: string;         // A human-readable message describing the outcome.\n  projectPath?: string;     // The absolute path to the created project directory (if successful or already exists).\n  projectFilePath?: string; // The absolute path to the created project Markdown file (if successful or already exists).\n}\n```\n\n## 4. Behavior\n\n### 4.1. Input Validation\n\n*   If `projectName` is empty or consists only of whitespace, the function returns `{ success: false, message: \'Project name cannot be empty.\' }`.\n*   If `config.gtd.projectsDir` is not defined in the provided `AppConfig`, the function logs an error and returns `{ success: false, message: \'GTD_PROJECTS_DIR is not configured in AppConfig.\' }`.\n\n### 4.2. Directory and File Creation\n\n1.  **Base Projects Directory:** It resolves the absolute path to the main projects directory using `config.gtd.projectsDir`. If this base directory does not exist, it attempts to create it.\n2.  **Project Directory Path:** Constructs the path for the new project\'s directory (e.g., `path/to/projects/MyProjectName`).\n3.  **Project File Path:** Constructs the path for the new project\'s main Markdown file (e.g., `path/to/projects/MyProjectName/MyProjectName.md`).\n\n### 4.3. Handling Existing Projects\n\n*   If a directory with the `projectName` already exists at the target location, the function will not overwrite it. It returns a result indicating failure:\n    ```typescript\n    {\n      success: false,\n      message: `Project \'${projectName}\' already exists at ${newProjectDir}.`,\n      projectPath: newProjectDir, // Path to the existing project directory\n      projectFilePath: existingProjectFilePath // Path to existing project file, if present\n    }\n    ```\n\n### 4.4. New Project Creation\n\n*   If the project does not already exist:\n    *   The project directory is created (e.g., `projects/MyProjectName/`).\n    *   The main project Markdown file is created (e.g., `projects/MyProjectName/MyProjectName.md`).\n    *   The project file is populated with the following initial content:\n        ```markdown\n        # Project: [projectName]\n\n        ## Overview\n\n\n        ## Tasks\n\n\n        ## Notes\n\n\n        ## Reference Material\n        ```\n\n### 4.5. Success\n\n*   On successful creation, the function returns:\n    ```typescript\n    {\n      success: true,\n      message: `Project \'${projectName}\' created successfully.`,\n      projectPath: newProjectDir,     // Path to the new project directory\n      projectFilePath: projectFilePath // Path to the new project file\n    }\n    ```\n\n### 4.6. Error Handling\n\n*   Any unexpected errors during file system operations (e.g., permission issues not allowing directory/file creation) are caught.\n*   An error is logged using Wooster\'s logger (`log(LogLevel.ERROR, ...)`).\n*   The function returns `{ success: false, message: \`Error creating project \'${projectName}\': ${error.message}\` }`.\n\n## 5. Dependencies\n\n*   `fs` (Node.js module): For file system operations (checking existence, creating directories, writing files).\n*   `path` (Node.js module): For path manipulation and resolution.\n*   `./configLoader` (Wooster module): Specifically for the `AppConfig` type, expecting `config.gtd.projectsDir`.\n*   `./logger` (Wooster module): For logging operational information and errors, using the `log` function and `LogLevel` enum.\n\n## 6. Example Conceptual Usage (from a Plugin)\n\n```typescript\n// Inside a Wooster plugin or service\nimport { createNewProject } from \'../newProject\'; // Adjust path as needed\nimport { AppConfig } from \'../configLoader\';\n\n// Assume \'this.config\' holds the loaded AppConfig\n\nasync function handleCreateProjectCommand(projectNameFromUser: string, currentAppConfig: AppConfig) {\n  if (!projectNameFromUser) {\n    return \"Please provide a project name.\";\n  }\n\n  const result = await createNewProject(projectNameFromUser, currentAppConfig);\n\n  if (result.success) {\n    return `Project \'${projectNameFromUser}\' created at ${result.projectFilePath}`;\n  } else {\n    return `Failed to create project: ${result.message}`;\n  }\n}\n```\n\nThis utility centralizes the logic for project creation, ensuring consistency and simplifying its use across different parts of the Wooster application.\n 